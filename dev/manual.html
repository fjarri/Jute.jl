<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Manual · Jute.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Jute.jl</span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li class="is-active"><a class="tocitem" href="manual.html">Manual</a><ul class="internal"><li><a class="tocitem" href="#Defining-tests"><span>Defining tests</span></a></li><li><a class="tocitem" href="#Basic-testcases-and-groups"><span>Basic testcases and groups</span></a></li><li><a class="tocitem" href="#Assertions"><span>Assertions</span></a></li><li><a class="tocitem" href="#Parametrizing-testcases"><span>Parametrizing testcases</span></a></li><li><a class="tocitem" href="#Testcase-tags"><span>Testcase tags</span></a></li><li><a class="tocitem" href="#run_options_manual"><span>Run options</span></a></li></ul></li><li><a class="tocitem" href="public.html">Public API</a></li><li><a class="tocitem" href="internals.html">Internals</a></li><li><a class="tocitem" href="history.html">Version history</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="manual.html">Manual</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="manual.html">Manual</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/fjarri/Jute.jl/blob/master/docs/src/manual.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Manual"><a class="docs-heading-anchor" href="#Manual">Manual</a><a id="Manual-1"></a><a class="docs-heading-anchor-permalink" href="#Manual" title="Permalink"></a></h1><h2 id="Defining-tests"><a class="docs-heading-anchor" href="#Defining-tests">Defining tests</a><a id="Defining-tests-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-tests" title="Permalink"></a></h2><p>The entry-point file (commonly called <code>runtests.jl</code>) is:</p><pre><code class="language-julia">using Jute

# Testcase definitions

exit(runtests())</code></pre><p>If there were no <a href="public.html#Jute.@testcase"><code>@testcase</code></a> and <a href="public.html#Jute.@testgroup"><code>@testgroup</code></a> calls before the call to <a href="public.html#Jute.runtests"><code>runtests()</code></a>, the test runner picks up any file with the name ending in <code>.test.jl</code> (by default; can be changed with the command-line option <code>--test-file-postfix</code>) in the directory where the entry-point file is located, or in any subdirectories. All those files are included at the same level (with <code>using Jute</code> at the start), and all the <a href="public.html#Jute.@testcase"><code>@testcase</code></a> and <a href="public.html#Jute.@testgroup"><code>@testgroup</code></a> definitions are picked up.</p><p>If some testcase definitions were present before the call to <a href="public.html#Jute.runtests"><code>runtests()</code></a>, they will be used and <strong>consumed</strong>, so the following calls to <a href="public.html#Jute.runtests"><code>runtests()</code></a> will follow the first scenario (loading testcases from files).</p><p>The <a href="public.html#Jute.@testgroup"><code>@testgroup</code></a> definitions can contain other <a href="public.html#Jute.@testgroup"><code>@testgroup</code></a> definitions and <a href="public.html#Jute.@testcase"><code>@testcase</code></a> definitions.</p><p>The <code>exit()</code> call is required to signal about any test failures to the processes that initiate the execution of the test suite, for instance, CI tools. <a href="public.html#Jute.runtests"><code>runtests()</code></a> returns <code>1</code> if there were failed tests, <code>0</code> otherwise.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>In all the following examples the <code>exit()</code> call will be missing because of the limitations of the <code>Documenter</code>&#39;s doctest runner. Also, <code>using Jute</code> will be implied.</p></div></div><h2 id="Basic-testcases-and-groups"><a class="docs-heading-anchor" href="#Basic-testcases-and-groups">Basic testcases and groups</a><a id="Basic-testcases-and-groups-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-testcases-and-groups" title="Permalink"></a></h2><p>In the simple case of a non-parametrized test, the <a href="public.html#Jute.@testcase"><code>@testcase</code></a> macro takes the testcase name and body. Testcases can be grouped using <a href="public.html#Jute.@testgroup"><code>@testgroup</code></a> definitions. For example:</p><pre><code class="language-julia">@testcase &quot;tc1&quot; begin
end

@testgroup &quot;group&quot; begin
    @testcase &quot;tc2&quot; begin
    end
end

@testgroup &quot;group2&quot; begin
    @testgroup &quot;subgroup&quot; begin
        @testcase &quot;tc3&quot; begin
        end
    end
end

runtests(; options=Dict(:verbosity =&gt; 2))

# output

Collecting testcases...
Using 3 out of 3 testcase definitions...
================================================================================
Platform: [...], Julia [...], Jute [...]
--------------------------------------------------------------------------------
tc1 ([...] ms) [PASS]
group/
  tc2 ([...] ms) [PASS]
group2/
  subgroup/
    tc3 ([...] ms) [PASS]
--------------------------------------------------------------------------------
3 tests passed, 0 failed, 0 errored in [...] s (total test time [...] s)</code></pre><p>The order of testcase definition is preserved. In other words, the testcases will be executed in the same order in which they were defined.</p><h2 id="Assertions"><a class="docs-heading-anchor" href="#Assertions">Assertions</a><a id="Assertions-1"></a><a class="docs-heading-anchor-permalink" href="#Assertions" title="Permalink"></a></h2><p><code>Jute</code> relies on the assertions from <a href="https://docs.julialang.org/en/latest/stdlib/Test/"><code>Test</code></a>; <a href="public.html#Test.@test"><code>@test</code></a>, <a href="public.html#Test.@test_throws"><code>@test_throws</code></a>, <a href="public.html#Test.@test_skip"><code>@test_skip</code></a>, <a href="public.html#Test.@test_broken"><code>@test_broken</code></a>, <a href="public.html#Test.@inferred"><code>@inferred</code></a>, <a href="public.html#Test.@test_warn"><code>@test_warn</code></a> and <a href="public.html#Test.@test_nowarn"><code>@test_nowarn</code></a> can be used. In addition, <code>Jute</code> has a <a href="public.html#Jute.@test_result"><code>@test_result</code></a> macro allowing one to return a custom result (e.g. the value of a benchmark from a testcase), and a <a href="public.html#Jute.@test_fail"><code>@test_fail</code></a> macro for providing custom information with a fail. There can be several assertions per testcase; their results will be reported separately. If the testcase does not call any assertions and does not throw any exceptions, it is considered to be passed.</p><h2 id="Parametrizing-testcases"><a class="docs-heading-anchor" href="#Parametrizing-testcases">Parametrizing testcases</a><a id="Parametrizing-testcases-1"></a><a class="docs-heading-anchor-permalink" href="#Parametrizing-testcases" title="Permalink"></a></h2><h3 id="Constant-fixtures"><a class="docs-heading-anchor" href="#Constant-fixtures">Constant fixtures</a><a id="Constant-fixtures-1"></a><a class="docs-heading-anchor-permalink" href="#Constant-fixtures" title="Permalink"></a></h3><p>The simplest method to parametrize a test is to supply it with an iterable:</p><pre><code class="language-julia">@testcase &quot;parametrized testcase&quot; for x in [1, 2, 3]
    @test x == x
end

runtests(; options=Dict(:verbosity =&gt; 2))

# output

Collecting testcases...
Using 1 out of 1 testcase definitions...
================================================================================
Platform: [...], Julia [...], Jute [...]
--------------------------------------------------------------------------------
parametrized testcase [1] ([...] ms) [PASS]
parametrized testcase [2] ([...] ms) [PASS]
parametrized testcase [3] ([...] ms) [PASS]
--------------------------------------------------------------------------------
3 tests passed, 0 failed, 0 errored in [...] s (total test time [...] s)</code></pre><p>By default, <code>Jute</code> uses <code>string()</code> to convert a fixture value to a string for reporting purposes. One can assign custom labels to fixtures by passing a <code>Pair</code> of iterables instead:</p><pre><code class="language-julia">@testcase &quot;parametrized testcase&quot; for x in ([1, 2, 3] =&gt; [&quot;one&quot;, &quot;two&quot;, &quot;three&quot;])
    @test x == x
end

runtests(; options=Dict(:verbosity =&gt; 2))

# output

Collecting testcases...
Using 1 out of 1 testcase definitions...
================================================================================
Platform: [...], Julia [...], Jute [...]
--------------------------------------------------------------------------------
parametrized testcase [one] ([...] ms) [PASS]
parametrized testcase [two] ([...] ms) [PASS]
parametrized testcase [three] ([...] ms) [PASS]
--------------------------------------------------------------------------------
3 tests passed, 0 failed, 0 errored in [...] s (total test time [...] s)</code></pre><p>A testcase can use several fixtures, in which case <code>Jute</code> will run the testcase function with all possible combinations of them:</p><pre><code class="language-julia">@testcase &quot;parametrized testcase&quot; for x in [1, 2], y in [3, 4]
    @test x + y == y + x
end

runtests(; options=Dict(:verbosity =&gt; 2))

# output

Collecting testcases...
Using 1 out of 1 testcase definitions...
================================================================================
Platform: [...], Julia [...], Jute [...]
--------------------------------------------------------------------------------
parametrized testcase [1,3] ([...] ms) [PASS]
parametrized testcase [1,4] ([...] ms) [PASS]
parametrized testcase [2,3] ([...] ms) [PASS]
parametrized testcase [2,4] ([...] ms) [PASS]
--------------------------------------------------------------------------------
4 tests passed, 0 failed, 0 errored in [...] s (total test time [...] s)</code></pre><p>Iterable unpacking is also supported:</p><pre><code class="language-julia">@testcase &quot;parametrized testcase&quot; for (x, y) in [(1, 2), (3, 4)]
    @test x + y == y + x
end

runtests(; options=Dict(:verbosity =&gt; 2))

# output

Collecting testcases...
Using 1 out of 1 testcase definitions...
================================================================================
Platform: [...], Julia [...], Jute [...]
--------------------------------------------------------------------------------
parametrized testcase [(1, 2)] ([...] ms) [PASS]
parametrized testcase [(3, 4)] ([...] ms) [PASS]
--------------------------------------------------------------------------------
2 tests passed, 0 failed, 0 errored in [...] s (total test time [...] s)</code></pre><p>Note that the label still refers to the full element of the iterable.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If the iterable expression evaluates to anything other than a fixture object, it will be treated as a constant fixture. In other words, if an expression like <code>for (x, y) in [fixture1, fixture2, fixture3]</code> is used to parametrize a testcase or a fixture, the nested fixtures will not be processed and added to the dependencies.</p></div></div><h3 id="Global-fixtures"><a class="docs-heading-anchor" href="#Global-fixtures">Global fixtures</a><a id="Global-fixtures-1"></a><a class="docs-heading-anchor-permalink" href="#Global-fixtures" title="Permalink"></a></h3><p>A global fixture is a more sophisticated variant of a constant fixture that has a setup and a teardown stage. For each value produced by the global fixture, the setup is called before the first testcase that uses it. As for the teardown, it is either called right away (if the option <code>instant_teardown</code> is <code>true</code>) or after the last testcase that uses it (if <code>instant_teardown</code> is <code>false</code>, which is the default). If no testcases use it (for example, they were filtered out), neither setup nor teardown will be called.</p><p>The setup and the teardown are defined by use of a single coroutine that produces the fixture value. The coroutine&#39;s first argument is a function that is used to return the value. If <code>instant_teardown</code> is <code>false</code>, the call blocks until it is time to execute the teardown:</p><pre><code class="language-julia">db_connection = @global_fixture begin
    c = db_connect()

    # this call blocks until all the testcases
    # that use this value are executed
    @produce c

    close(c)
end</code></pre><p>Similarly to the constant fixture case, one can provide a custom identifier for the fixture via the optional second argument of <a href="public.html#Jute.@produce"><code>@produce</code></a>:</p><pre><code class="language-julia">db_connection = @global_fixture begin
    c = db_connect()

    @produce c &quot;db_connection&quot;

    close(c)
end</code></pre><p>Global fixtures can be parametrized by other constant or global fixtures. Similarly to the test parametrization, all possible combinations of parameters will be used to produce values:</p><pre><code class="language-julia">fx1 = @global_fixture for x in 3:4
    @produce x
end

fx2 = @global_fixture for x in 1:2, y in fx1
    @produce (x, y)
end

@testcase &quot;tc&quot; for x in fx2
    @test length(x) == 2
end

runtests(; options=Dict(:verbosity =&gt; 2))

# output

Collecting testcases...
Using 1 out of 1 testcase definitions...
================================================================================
Platform: [...], Julia [...], Jute [...]
--------------------------------------------------------------------------------
tc [(1, 3)] ([...] ms) [PASS]
tc [(1, 4)] ([...] ms) [PASS]
tc [(2, 3)] ([...] ms) [PASS]
tc [(2, 4)] ([...] ms) [PASS]
--------------------------------------------------------------------------------
4 tests passed, 0 failed, 0 errored in [...] s (total test time [...] s)</code></pre><h3 id="Local-fixtures"><a class="docs-heading-anchor" href="#Local-fixtures">Local fixtures</a><a id="Local-fixtures-1"></a><a class="docs-heading-anchor-permalink" href="#Local-fixtures" title="Permalink"></a></h3><p>A local fixture is a fixture whose value is created right before each call to the testcase function and destroyed afterwards. A simple example is a fixture that provides a temporary directory:</p><pre><code class="language-julia">temporary_dir = @local_fixture begin
    dir = mktempdir()
    @produce dir &quot;tempdir&quot; # this call will block while the testcase is being executed
    rm(dir, recursive=true)
end

@testcase &quot;tempdir test&quot; for dir in temporary_dir
    @test isdir(dir)
end

runtests(; options=Dict(:verbosity =&gt; 2))

# output

Collecting testcases...
Using 1 out of 1 testcase definitions...
================================================================================
Platform: [...], Julia [...], Jute [...]
--------------------------------------------------------------------------------
tempdir test [tempdir] ([...] ms) [PASS]
--------------------------------------------------------------------------------
1 tests passed, 0 failed, 0 errored in [...] s (total test time [...] s)</code></pre><p>Local fixtures can be parametrized by any other type of fixture, including other local fixtures.</p><h2 id="Testcase-tags"><a class="docs-heading-anchor" href="#Testcase-tags">Testcase tags</a><a id="Testcase-tags-1"></a><a class="docs-heading-anchor-permalink" href="#Testcase-tags" title="Permalink"></a></h2><p>Testcases can be assigned tags of the type <code>Symbol</code>. This can be used to establish a secondary grouping, independent of the primary grouping provided by modules. For example, one can tag performance tests, tests that run for a long time, unit/integration tests, tests that require a specific resource and so on. Testcases can be filtered by tags they have or don&#39;t have using <a href="manual.html#run_options_manual">command-line arguments</a>.</p><p>The tagging is performed by the optional parameter <code>tag</code> to the macro <a href="public.html#Jute.@testcase"><code>@testcase</code></a> that takes a list of <code>Symbol</code>s:</p><pre><code class="language-julia">@testcase tags=[:foo] &quot;foo&quot; begin
end

@testcase tags=[:bar, :baz] &quot;bar and baz&quot; begin
end

runtests(; options=Dict(:verbosity =&gt; 2, :include_only_tags =&gt; [:baz]))

# output

Collecting testcases...
Using 1 out of 2 testcase definitions...
================================================================================
Platform: [...], Julia [...], Jute [...]
--------------------------------------------------------------------------------
bar and baz ([...] ms) [PASS]
--------------------------------------------------------------------------------
1 tests passed, 0 failed, 0 errored in [...] s (total test time [...] s)</code></pre><h2 id="run_options_manual"><a class="docs-heading-anchor" href="#run_options_manual">Run options</a><a id="run_options_manual-1"></a><a class="docs-heading-anchor-permalink" href="#run_options_manual" title="Permalink"></a></h2><p><code>Jute</code>&#39;s <a href="public.html#Jute.runtests"><code>runtest()</code></a> picks up the options from the command line by default. Alternatively, they can be set with the <code>options</code> keyword argument of <a href="public.html#Jute.runtests"><code>runtests()</code></a>. Note that command-line arguments override the ones passed via <code>options</code>.</p><article class="docstring"><header><a class="docstring-binding" id="Jute.build_parser" href="#Jute.build_parser"><code>Jute.build_parser</code></a> — <span class="docstring-category">Function</span></header><section><div><p>For every option, the corresponding command-line argument names are given in parentheses. If supplied via the <code>options</code> keyword argument of <a href="public.html#Jute.runtests"><code>runtests()</code></a>, their type must be as given or <code>convert()</code>-able to it.</p><p><strong><code>:include_only</code></strong><code>:: Union{Nothing, Regex}</code> (<code>--include-only</code>, <code>-i</code>): takes a regular expression; tests with full names that do not match it will not be executed.</p><p><strong><code>:exclude</code></strong><code>:: Union{Nothing, Regex}</code> (<code>--exclude</code>, <code>-e</code>): takes a regular expression; tests with full names that match it will not be executed.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The full name refers to the name of the testcase and all its parent groups, separated by slashes (<code>/</code>). For example, the full name of the testcase &quot;foo&quot; in the group &quot;bar&quot;, which, in turn, is defined in the group &quot;baz&quot;, will be &quot;baz/bar/foo&quot;.</p></div></div><p><strong><code>:verbosity</code></strong><code>:: Int</code> (<code>--verbosity</code>, <code>-v</code>): <code>0</code>, <code>1</code> or <code>2</code>, defines the amount of output that will be shown. <code>1</code> is the default.</p><p><strong><code>:include_only_tags</code></strong><code>:: Array{Symbol, 1}</code> (<code>--include-only-tags</code>, <code>-t</code>): include only tests with any of the specified tags. You can pass several tags to this option, separated by spaces.</p><p><strong><code>:exclude_tags</code></strong><code>:: Array{Symbol, 1}</code> (<code>--exclude-tags</code>, <code>-n</code>): exclude tests with any of the specified tags. You can pass several tags to this option, separated by spaces.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Programmatically (using <code>options</code> keyword of <a href="public.html#Jute.runtests"><code>runtests</code></a>) tags must be passed as symbols.</p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If <code>-</code> is one of the arguments to <code>include_only_tags</code> or <code>exclude_tags</code>, it is equivalent to not passing anything for these options at all (all other values passed to them will be ignored). This can be helpful when overriding the options passed programmatically to <a href="public.html#Jute.runtests"><code>runtests()</code></a>.</p></div></div><p><strong><code>:max_fails</code></strong><code>:: Int</code> (<code>--max-fails</code>): stop after the given amount of failed testcases (a testcase is considered failed if at least one test in it failed, or an unhandled exception was thrown).</p><p><strong><code>:test_file_postifx</code></strong><code>:: String</code> (<code>--test-file-postfix</code>): postfix of the files which will be picked up by the automatic testcase discovery.</p><p>The flag arguments are processed in a special way if a non-default value is passed via the <code>options</code> keyword argument of <a href="public.html#Jute.runtests"><code>runtests()</code></a>. In this case, the command-line option is replaced by its inverse (given second in the parentheses), with the corresponding change in the default.</p><p><strong><code>:capture_output</code></strong><code>:: Bool</code> (<code>--capture-output</code>/<code>--dont-capture-output</code>): capture all the output from testcases and only show the output of the failed ones at the end of the test run.</p><p><strong><code>:dont_add_runtests_path</code></strong><code>:: Bool</code> (<code>--dont-add-runtests-path</code>/<code>--add-runtests-path</code>): do not push the test root path into <code>LOAD_PATH</code> before including test files</p><p><strong><code>:color_(pass/fail/error/broken/return)</code></strong><code>:: Symbol</code> (<code>--color-(pass/fail/error/broken/return)</code>): custom colors to use in the report. Supported colors: default, blink, light_cyan, white, hidden, blue, light_yellow, bold, cyan, light_blue, magenta, normal, red, black, light_green, green, light_magenta, light_black, light_red, nothing, yellow, reverse, underline.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Programmatically (using <code>options</code> keyword of <a href="public.html#Jute.runtests"><code>runtests</code></a>) colors must be passed as symbols.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjarri/Jute.jl/blob/421c6c9b47f0150c246cec0005fb8b98a8d5b5f1/src/options.jl#L45-L115">source</a></section></article><p>Run options can be accessed from a testcase or a fixture via the built-in fixture <a href="public.html#Jute.run_options"><code>run_options</code></a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="index.html">« Home</a><a class="docs-footer-nextpage" href="public.html">Public API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 1 January 2021 06:24">Friday 1 January 2021</span>. Using Julia version 1.2.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
